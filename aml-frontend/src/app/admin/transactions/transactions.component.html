<div class="container-fluid py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2><i class="fas fa-exchange-alt me-2"></i>Transactions</h2>
    <div class="d-flex align-items-center gap-2">
      <div class="btn-group" role="group" aria-label="Status filter">
        <button class="btn btn-sm" [ngClass]="status === '' ? 'btn-primary' : 'btn-outline-primary'" (click)="setStatus('')">All</button>
        <button class="btn btn-sm" [ngClass]="status === 'PENDING' ? 'btn-warning' : 'btn-outline-warning'" (click)="setStatus('PENDING')">Pending</button>
        <button class="btn btn-sm" [ngClass]="status === 'FLAGGED' ? 'btn-info' : 'btn-outline-info'" (click)="setStatus('FLAGGED')">Flagged</button>
        <button class="btn btn-sm" [ngClass]="status === 'BLOCKED' ? 'btn-danger' : 'btn-outline-danger'" (click)="setStatus('BLOCKED')">Blocked</button>
      </div>
      <div class="search-box d-flex align-items-center">
        <i class="fas fa-search me-2 text-muted"></i>
        <input class="form-control" placeholder="Search (type, acc no, status, desc)" [(ngModel)]="search" (ngModelChange)="applyFilter()" />
      </div>
    </div>
  </div>

  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary"></div>
    <p class="mt-3 text-muted">Loading transactions...</p>
  </div>

  <div *ngIf="error && !loading" class="alert alert-danger">{{ error }}</div>

  <div *ngIf="!loading" class="card shadow-sm">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th>#</th>
            <th>Reference</th>
            <th>Type</th>
            <th>From</th>
            <th>To</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Risk</th>
            <th>Created</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let t of filteredTx; index as i">
            <td>{{ i + 1 }}</td>
            <td><code>{{ t.transactionReference || t.id }}</code></td>
            <td>{{ t.transactionType }}</td>
            <td>{{ t.fromAccountNumber || '-' }}</td>
            <td>{{ t.toAccountNumber || '-' }}</td>
            <td>{{ t.amount | number:'1.2-2' }} {{ t.currency }}</td>
            <td>
              <span class="badge" [ngClass]="{
                'bg-secondary': t.status === 'APPROVED',
                'bg-warning text-dark': t.status === 'PENDING',
                'bg-info text-dark': t.status === 'FLAGGED',
                'bg-danger': t.status === 'BLOCKED',
                'bg-dark': t.status === 'REJECTED'
              }">{{ t.status }}</span>
            </td>
            <td>{{ t.combinedRiskScore || '-' }}</td>
            <td>{{ t.createdAt | date:'short' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div *ngIf="!filteredTx?.length" class="p-4 text-center text-muted">No transactions found.</div>
  </div>
</div>
